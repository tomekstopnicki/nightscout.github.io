<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Security - Nightscout</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../css/admonitions.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Nightscout</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../.." class="dropdown-item">What is Nightscout?</a>
</li>
                                    
<li>
    <a href="../../uploader/uploaders/" class="dropdown-item">How do I upload my data?</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Install <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../insights/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../new_user/" class="dropdown-item">Installation</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Configure <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../setup_variables/" class="dropdown-item">Configure your Nightscout</a>
</li>
                                    
<li>
    <a href="../../uploader/setup/" class="dropdown-item">Configure your Uploader</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item">Secure your site</a>
</li>
                                    
<li>
    <a href="../downloaders/" class="dropdown-item">Follower Devices</a>
</li>
                                    
<li>
    <a href="../wearable/" class="dropdown-item">Nightscout on your watch</a>
</li>
                                    
<li>
    <a href="../multiadmin/" class="dropdown-item">Running multiple sites</a>
</li>
                                    
<li>
    <a href="../close_loop/" class="dropdown-item">Closed-loop Systems</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item">Security</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Use <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../discover/" class="dropdown-item">Discover your site</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item">Secure your site</a>
</li>
                                    
<li>
    <a href="../reports/" class="dropdown-item">Reports</a>
</li>
                                    
<li>
    <a href="../profile_editor/" class="dropdown-item">Profile Editor</a>
</li>
                                    
<li>
    <a href="../admin_tools/" class="dropdown-item">Admin Tools</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Security</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Update <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../update/update/" class="dropdown-item">Updating your site</a>
</li>
                                    
<li>
    <a href="../../update/redeploy/" class="dropdown-item">Redeploying</a>
</li>
                                    
<li>
    <a href="../../update/newdatabase/" class="dropdown-item">Attach a new Atlas database</a>
</li>
                                    
<li>
    <a href="../../update/upd_stack/" class="dropdown-item">Update Heroku Stack</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Troubleshoot <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../troubleshoot/troublehoot/" class="dropdown-item">Troubleshooting</a>
</li>
                                    
<li>
    <a href="../../troubleshoot/connection_string/" class="dropdown-item">Connection failure</a>
</li>
                                    
<li>
    <a href="../../troubleshoot/cleanup/" class="dropdown-item">Cleanup</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../admin_tools/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../update/update/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#nightscout-security" class="nav-link">Nightscout Security</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#security-and-safekeeping" class="nav-link">Security and safekeeping</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#https-and-certificate-errors" class="nav-link">HTTPS and certificate errors</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#administration-messages" class="nav-link">Administration messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#renaming-the-nightscout-site" class="nav-link">Renaming the Nightscout site</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#how-to-turn-off-unauthorized-access" class="nav-link">How to Turn Off Unauthorized Access</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#create-authentication-tokens-for-users" class="nav-link">Create Authentication Tokens for Users</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#developers-api-authorization" class="nav-link">Developers: API authorization</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="nightscout-security">Nightscout Security<a class="headerlink" href="#nightscout-security" title="Permanent link">⌁</a></h2>
<p>Nightscout security model is based on the following assumptions:</p>
<ul>
<li>The users of Nightscout only use it to process information about themselves or someone they're legally responsible for and thus own all of the data being stored in Nightscout.</li>
<li>Given the user / operator of Nightscout is assumed to have full ownership of the data stored in Nightscout, it is assumed the user has full responsibility around the use and sharing of the data.</li>
<li>Nightscout provides a set of APIs for reading and writing data into the Nightscout database. Nightscout itself does not directly interface with any devices. Nightscout users should verify any applications using the APIs to process the data in Nightscout have been implemented in a secure fashion and have data validation processes in place in case an unauthorized user gains access to Nightscout and alters the data.</li>
<li>If unauthorized users gain access to the server being used to host Nightscout, the database used with Nightscout or any device used to access the Nightscout APIs, the entire system's security has to be considered compromised and the user must assume any data stored in the system might be altered and thus should not be trusted.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Personal use only</p>
<p>The system has not been designed for scenarios where a third party operates a Nightscout installation on behalf of others and if such installations are made, both the users and operators of such installations need to understand there is a large body of legislation across the world that covers use cases and data storage enabled by Nightscout and the liability issues around such installations are extremely complicated.</p>
</div>
<p></br></p>
<h2 id="security-and-safekeeping">Security and safekeeping<a class="headerlink" href="#security-and-safekeeping" title="Permanent link">⌁</a></h2>
<ul>
<li>Use the same email address for all accounts so you'll have access to all your accounts after installation. Do not use a disposable email address - use something you know you can access later.</li>
<li>Use a safe password for all accounts related to Nightscout, including the password for the email account for the accounts. We highly recommend using a password manager such as 1Password and allowing it to generate the passwords for you.</li>
<li>Do not reuse the same password for all your accounts.</li>
<li>Do not use your Dexcom or CareLink user name or password for Nightscout components.</li>
<li>Do not use the API_SECRET for the Atlas database password.</li>
<li>Do not share the API_SECRET or access tokens with administration privileges to anyone, ever. If you need to grant access to Nightscout, see below for instructions how to create access tokens for this purpose.</li>
<li>Do not use Nightscout or any related applications on rooted and/or otherwise compromised devices, and ensure you always have the latest operating system and virus protection updates installed.</li>
</ul>
<p></br></p>
<h2 id="https-and-certificate-errors">HTTPS and certificate errors<a class="headerlink" href="#https-and-certificate-errors" title="Permanent link">⌁</a></h2>
<p>One of the core security mechanisms on web is the SSL encryption applied to HTTP connections. When installed to Heroku, Nightscout by default forces connections to use HTTPS, thus ensuring the connection is encrypted. For secure Nightscout use, it's crucial that you assume something is wrong if you ever see your browser complain the SSL certificate of your Nightscout site does not match or work as expected by the browser. This can be a sign of a so called Man In The Middle (MITM) attack and proceeding with the problematic certificate will subsequently compromise your Nightscout site. If you see an error related to SSL, you should immediately rename the site (see below for instructions).</p>
<p></br></p>
<h2 id="administration-messages">Administration messages<a class="headerlink" href="#administration-messages" title="Permanent link">⌁</a></h2>
<p>Nightscout 14.2 introduced a new feature called Admin Notifies, which can warn you about issues with Nightscout installation and security issues.</p>
<p>If you see the red megaphone in your navigation bar, it means you have messages in the queue.</p>
<p><img src="../img/notifies_1.png" style="zoom:80%;" /></p>
<p>You have to be authenticated to Nightscout using the API_SECRET or an authentication token that has administration access to read the messages.</p>
<p><img src="../img/notifies_2.png" style="zoom:50%;" /></p>
<p>There are multiple types of messages that might be shown.</p>
<p><img src="../img/notifies_3.png" style="zoom:50%;" /></p>
<p></br></p>
<h3 id="im-seeing-a-message-about-the-api_secret-being-weak">I'm seeing a message about the API_SECRET being weak<a class="headerlink" href="#im-seeing-a-message-about-the-api_secret-being-weak" title="Permanent link">⌁</a></h3>
<p>This message is shown when cryptographic analysis if the API_SECRET shows the secret is easily guessable by a computer and should be changed. Things you can do to have this message go away:</p>
<ul>
<li>The API_SECRET must be at least 12 characters long, but making it even longer makes it more secure</li>
<li>Use a mix of small and CAPITAL letters, numbers and non-alphanumeric characters such as !#%&amp;/()= in the API_SECRET
  <em>Note: make sure your uploader and downloaders can handle special characters, you might need to express them using <a href="https://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_reserved_characters">Percent encoding</a></em></li>
<li>Consider generating the API_SECRET using a password manager</li>
</ul>
<p>The API_SECRET is set in the Heroku Settings (see <a href="../setup_variables/#editing-config-vars-in-heroku">here</a> on how to edit the variables).</p>
<p></br></p>
<h3 id="im-seeing-a-message-about-authentication-failures">I'm seeing a message about authentication failures<a class="headerlink" href="#im-seeing-a-message-about-authentication-failures" title="Permanent link">⌁</a></h3>
<p>This is highly likely caused by you having installed an app on some device with the wrong API_SECRET or access token, and the app trying to authenticate to your Nightscout, or you or one of the family members have just tried to sign into Nightscout with wrong credentials.</p>
<p>If you have apps running that use the Nightscout REST API, check you have the correct API_SECRET and/or access token configured to each.</p>
<p>If the message keeps appearing unexpectedly or is reported against multiple IP numbers, it's possible someone is trying to brute force attack your installation and guess your API_SECRET to be able to modify data in your Nightscout. In this situation, we highly recommend you rename the Nightscout site in Heroku to change it's address and pick a name that's hard to guess.</p>
<p></br></p>
<h3 id="im-seeing-a-message-nightscout-is-readable-by-the-world">I'm seeing a message Nightscout is readable by the world<a class="headerlink" href="#im-seeing-a-message-nightscout-is-readable-by-the-world" title="Permanent link">⌁</a></h3>
<p>This means the site shows the CGM data to users who can guess the site address without authentication. Note Nightscout never allows data to be saved or edited without authentication, so this is not necessarily a problem depending on how hard your site address is to guess and how you want the information to be shared.</p>
<p>If you want to have the site require authentication, read the "How to Turn Off Unauthorized Access" section below.</p>
<p></br></p>
<h2 id="renaming-the-nightscout-site">Renaming the Nightscout site<a class="headerlink" href="#renaming-the-nightscout-site" title="Permanent link">⌁</a></h2>
<p>The site is renamed, thus changing the site URL, in the Heroku settings:</p>
<p><img src="../img/rename.png" style="zoom:50%;" /></p>
<p></br></p>
<h2 id="how-to-turn-off-unauthorized-access">How to Turn Off Unauthorized Access<a class="headerlink" href="#how-to-turn-off-unauthorized-access" title="Permanent link">⌁</a></h2>
<div class="admonition warning">
<p class="admonition-title">Privacy warning</p>
<p>In a default setup, <strong>anyone</strong> with your Nightscout URL can view your site.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure <a href="../downloaders">the app you use to see your data</a> can handle a secured Nightscout site.</p>
</div>
<p>To Take Advantage of Roles, Turn Off Unauthorized Access to Your Site:</p>
<p>If you want to ensure that ONLY someone with permission to view your site (e.g., a token) is able to view the data, you should configure the <a href="../setup_variables/#auth_default_roles"><code>AUTH_DEFAULT_ROLES</code></a> variable in Heroku. Set the value as: <code>denied</code>.</p>
<p><a href="../setup_variables/#editing-config-vars-in-heroku">Edit</a> (or add) your variable in Heroku and set it to <code>denied</code>.</p>
<p><img src="../img/Admin03.png" style="zoom:100%;" /></p>
<p></br></p>
<p>This creates a scenario in which a token will be required for all access (even only view).</p>
<p><img src="../img/Admin02.png" style="zoom:80%;" /></p>
<p></br></p>
<h2 id="create-authentication-tokens-for-users">Create Authentication Tokens for Users<a class="headerlink" href="#create-authentication-tokens-for-users" title="Permanent link">⌁</a></h2>
<div class="admonition note">
<p class="admonition-title">Note: authentication tokens are also called access tokens</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Changing <a href="../setup_variables/#api_secret"><code>API_SECRET</code></a></p>
<p>If you change your <code>API_SECRET</code> all your tokens will change. Make sure you update your devices and send the new token link to those you allowed to access your Nightscout</p>
</div>
<p>To access the Authentication options, click the settings panel (three horizontal bars in the top right) in your website and select Admin Tools. The Authentication options are at the top of the Admin page. (Note: you must be logged in with your <code>API SECRET</code> to access these tools.)</p>
<p><img src="../img/Admin04.png" style="zoom:80%;" /></p>
<p></br></p>
<p>You will see several predefined roles:</p>
<p><img src="../img/Admin01.png" style="zoom:80%;" /></p>
<p></br></p>
<h4 id="roles">Roles<a class="headerlink" href="#roles" title="Permanent link">⌁</a></h4>
<ul>
<li><strong><code>admin</code></strong>: full access</li>
<li><strong><code>careportal</code></strong>: can view the site and make CarePortal/treatment entries</li>
<li><strong><code>readable</code></strong>: read-only access; no ability to make CarePortal/treatment entries. This user CAN see reports and profile information.</li>
<li><strong><code>denied</code></strong>: no access (this role only works if the <code>AUTH_DEFAULT_ROLES</code> setting is also <code>denied</code>. You can’t have a site that is readable to everyone and create a “denied” token for a specific user.)</li>
<li><strong><code>devicestatus-upload</code></strong>: used by devices</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently no way to limit a user so that he cannot view the Reports section if he has access to the site. Time/date-based roles are not currently possible.</p>
</div>
<p></br></p>
<h3 id="create-a-token">Create a Token<a class="headerlink" href="#create-a-token" title="Permanent link">⌁</a></h3>
<ul>
<li>Click the “Add New Subject” button.</li>
</ul>
<p><img src="../img/Admin00.png" style="zoom:80%;" /></p>
<p></br></p>
<ul>
<li>Fill in the name of the subject and the “role” you are giving this subject (from the list of roles shown above). Note you should only grant the <code>readable</code> role for users who do not need to save or edit data in Nightscout. For example, you might want to share the site to a school nurse, but not have him able edit the data.</li>
</ul>
<p><img src="../img/Admin05.png" style="zoom:80%;" /></p>
<p></br></p>
<ul>
<li>Click save.</li>
<li>The token will be shown. You can use it in two different ways:</li>
<li>Copy the token URL (right-click on it in the browser and select the option to copy the link address) and provide it to the user (e.g., paste it into an email). If the user enters the entire URL (with token), the token will be in effect. </li>
<li>Copy the token string (in the example below <code>school-a595d5f0aeff64c0</code>) and use it for authentication at site opening, instead of the API secret (Nightscout minimum version 14.1.0 required).</li>
</ul>
<p><img src="../img/Admin06.png" style="zoom:80%;" /></p>
<p></br></p>
<p>You can also add the token to the site URL to authenticate using a token. Your site link with token will look like this:</p>
<p><code>https://yoursitename.herokuapp.com/?token=school-a595d5f0aeff64c0</code></p>
<p>Anybody with this link can use your Nightscout with the role defined for this token.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user copies only your core URL into a browser, and your site is readable by default, the token will be bypassed. (Possible strategies to ensure the user puts the role-based URL into a browser include using a tinyurl or bit.ly.)</p>
</div>
<ul>
<li>You can edit a subject by clicking the edit icon, making changes, and saving.</li>
<li>You can delete a subject by clicking the “x” icon to remove the subject from the list.</li>
</ul>
<p></br></p>
<h2 id="developers-api-authorization">Developers: API authorization<a class="headerlink" href="#developers-api-authorization" title="Permanent link">⌁</a></h2>
<p>See <a href="https://github.com/nightscout/cgm-remote-monitor/wiki/API-v1-Security">this page</a> for how to authenticate your app in the API calls.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
